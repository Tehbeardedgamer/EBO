Numeric Input EXA_TEMP,OA_TEMP,EXA_DAMPER_CMD_BYPASS,CHW_SA_TEMP, ERW_SS,ERW_SA_TEMP,OCC_SCHEDULE
Numeric Output COOLING_MODE, ECONCOOLING_MODE, ECONOMIZER_MODE, HEATING_MODE,OCCUPIED_MODE,UNOCCUPIED_MODE


goto isOCCUPIED

isOCCUPIED:
If OCC_SCHEDULE = on Then OCCUPIED_MODE = on and UNOCCUPIED_MODE = off 
else OCCUPIED_MODE = off and UNOCCUPIED_MODE = on

Goto DETERMINE_MODE

DETERMINE_MODE:

'COOLING MODE

If  OA_TEMP > (EXA_TEMP + 2) then COOLING_MODE = on
    Else COOLING_MODE = off

'ECONOMIZER COOLING MODE


If OA_TEMP < EXA_TEMP And OA_TEMP > CHW_SA_TEMP  then ECONCOOLING_MODE = on
    Else ECONCOOLING_MODE = off

'ECONOMIZER MODE

If OA_TEMP < (CHW_SA_TEMP - 2) then ECONOMIZER_MODE = on and ERW_SS = On
    Else ECONOMIZER_MODE = off

'HEATING MODE

If  ERW_SS = on And EXA_DAMPER_CMD_BYPASS = off And ERW_SA_TEMP < (CHW_SA_TEMP - 2) Then HEATING_MODE = on
    Else HEATING_MODE = off

Goto WAIT_LOOP

WAIT_LOOP:
Wait 60